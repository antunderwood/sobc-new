<li <%= raw "class=\"dropdown\"" if depth == 1 && !menu_item[:children].blank? %> >
  <a href="<%= (depth == 1 && !menu_item[:children].blank?) ? "#" : menu_item[:url] %>" <%= raw "class=\"dropdown-toggle\" data-toggle=\"dropdown\"" if depth == 1  && !menu_item[:children].blank? %> ><%= menu_item[:name] %> <%= raw "<b class=\"caret\"></b>" if depth == 1  && !menu_item[:children].blank? %> </a>
  <% unless menu_item[:children].blank? %>
    <ul <%= raw "class=\"dropdown-menu\"" if depth == 1 && !menu_item[:children].blank? %> >
      <% menu_item[:children].each_with_index do |item, i|%>
        <%= render :partial => "/cms/menus/menu_item", :object => item, :locals => { :depth => depth + 1, :position => i + 1, :item_count => menu_item[:children].length } %>
      <% end %>
    </ul>
  <% end %>
</li>